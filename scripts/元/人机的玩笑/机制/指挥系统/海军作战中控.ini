[核心]
name:海军作战中控
tags:海军作战中控, 作战中控
复制与:作战通用模块.ini
@memory 目标:unit[]
@memory 攻击目标:unit
不可选择:真

[资源_海军最高战力]
隐藏:真

[资源_海军战力]
隐藏:真

[图像]
image:海军.png
可见性:假

[运动]
运动类型:水面
移动速度:0.8

[行动_信息]
可见性:真
text:%{内存.攻击目标.resource.总战力} \n%{选择(自身有标签(包含标签="开始进攻"), '只手炼化', '道友饶命')}
建造速度:0s
显示类型:infoOnly
显示给盟友:真
显示给敌人:真
界面闪烁:真
pos:0

[隐藏行动_检索敌人]
自动触发:if not 自身有活动的路径点(type='靠近目标')
需要条件:if 敌人有此单位数量(需标签="海", 范围内=300, 超过=0) or 敌人有此单位数量(需标签="海", 范围内=540, 超过=0) and not 自身有标签(包含标签="开始进攻")
清除所有路径点:真
添加路径点动作类型:靠近目标
添加路径点检索标签:修复, 海厂
添加路径点路径可达:假
添加路径点靠近队伍:盟友

[隐藏行动_判断战力]
自动触发:真
需要条件:if not 自身有标签(包含标签="开始进攻") and not 自身有活动的路径点(type='靠近目标')
添加路径点动作类型:攻击
添加指定标签的随机单位:海军区块
添加指定队伍的随机单位:敌方
添加路径点匹配触发:更新军队, 更新最高

[隐藏行动_更新军队]
需要条件:if 自身资源.海军战力<(活动路径点目标.读取单位内存('对地总战力', type='float')+活动路径点目标.读取单位内存('对地总战力X', type='float')) and 自身有活动的路径点(type='攻击')
用逻辑设置资源:海军战力=(活动路径点目标.读取单位内存('对地总战力', type='float')+活动路径点目标.读取单位内存('对地总战力X', type='float'))
设置单位内存:目标[0]=活动路径点目标

[隐藏行动_更新最高]
需要条件:if 自身资源.海军最高战力<活动路径点目标.resource.总战力
用逻辑设置资源:海军最高战力=活动路径点目标.resource.总战力
设置单位内存:目标[1]=活动路径点目标

[隐藏行动_检索战力]
提取资源标签:海军
提取资源触发行为:军队战力

[隐藏行动_检索盟友]
提取资源标签:海军作战中控
提取资源触发行为:盟友战力

[隐藏行动_战力重新计算]
用逻辑设置资源:海军最高战力=选择(自身有标签(包含标签="开始进攻"), 自身资源.海军最高战力, 0), 海军战力=选择(自身有标签(包含标签="开始进攻"), 自身资源.海军战力, 0)

[隐藏行动_唯一]
自动触发:真
需要条件:if not 自身有标签(包含标签="发起进攻") and 自身资源.时间%15==2 and not 自身有活动的路径点(type='靠近目标')
清除所有路径点:真
添加路径点路径可达:真
添加路径点动作类型:攻击
添加路径点检索标签:海军作战中控
添加路径点靠近队伍:己方
添加路径点匹配触发:比较

[隐藏行动_比较]
需要条件:if 活动路径点目标.timeAlive>存活时间
也执行动作:区块消失

[隐藏行动_区块消失]
自动触发:真
需要条件:if 自身有资源(冷却=30)

[隐藏行动_判断分散]
自动触发:真
需要条件:if 队伍中此单位数量(需标签="海军", 范围内=460)>(队伍中此单位数量(需标签="海军", 范围内=300)*(1+队伍中此单位数量(需标签="海军", 范围内=460)*0.0036)) and 自身资源.时间%5==3 and 自身资源.总战力<自身资源.海军最高战力*1.275 and not 自身有标签(包含标签="开始进攻") and 自身资源.时间%15>=3
临时标签删除:聚集, 开始进攻, 发起进攻
临时标签添加:未下达指令

[隐藏行动_判断聚集]
自动触发:真
需要条件:if 队伍中此单位数量(需标签="海军", 范围内=460)<=(队伍中此单位数量(需标签="海军", 范围内=300)*(1+队伍中此单位数量(需标签="海军", 范围内=460)*0.0036)) or 自身资源.总战力>=自身资源.海军最高战力*1.275 and 队伍中此单位数量(需标签="海军", 范围内=250, 超过=0)
临时标签添加:聚集

[隐藏行动_判断进攻]
自动触发:if 敌人有此单位数量(需标签="海", 范围内=300, 少于=1) and 自身有标签(包含标签="开始进攻") or 敌人有此单位数量(需标签="海", 范围内=540, 少于=1)
需要条件:if 自身有资源(总战力=52) and 自身有标签(包含标签="聚集") and 自身资源.时间%15>=3 and not 自身有活动的路径点(type='follow') or 自身有标签(包含标签="开始进攻") and not 自身有活动的路径点(type='follow')
临时标签删除:未下达指令
清除所有路径点:真
添加路径点动作类型:follow
添加路径点检索标签:海军区块
添加路径点靠近队伍:敌方
添加路径点匹配触发:存储战力
添加路径点失败触发:攻海厂

[隐藏行动_攻海厂]
添加路径点动作类型:follow
添加路径点检索标签:海厂
添加路径点靠近队伍:敌方
添加路径点失败触发:攻岛矿

[隐藏行动_攻岛矿]
添加路径点动作类型:follow
添加路径点检索标签:抽取器
添加路径点靠近队伍:敌方
添加路径点失败触发:区块消失

[隐藏行动_存储战力]
设置单位内存:攻击目标=活动路径点目标
也执行动作:更换目标

[隐藏行动_更换目标]
需要条件:if 活动路径点目标.resource.总战力==0 and 活动路径点目标.tags(包含标签="海军区块") and 自身资源.时间%15>=3
清除所有路径点:真
添加路径点动作类型:follow
添加指定标签的随机单位:海军区块
添加指定队伍的随机单位:敌方
添加路径点匹配触发:存储战力
添加路径点失败触发:攻海厂

[隐藏行动_发起进攻]
自动触发:真
需要条件:if 自身有标签(包含标签="聚集") and 自身资源.总战力>=内存.攻击目标.resource.总战力*1.144 and 自身资源.时间%15>=3
临时标签添加:开始进攻
临时标签删除:发起撤退

[隐藏行动_开始作战]
自动触发:真
需要条件:if 自身有标签(包含标签="开始进攻") and 敌人有此单位数量(需标签="海", 范围内=460, 超过=0)
临时标签添加:海军进攻

[隐藏行动_取消进攻]
自动触发:真
需要条件:if 自身资源.总战力<内存.攻击目标.resource.总战力*1.144 and 自身资源.时间%15>=3
临时标签删除:开始进攻, 海军进攻