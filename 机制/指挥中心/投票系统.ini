[core]
name:投票系统
dont_load:true
copyFrom:通用模块.ini
@memory 难度:string
@memory 通告:string
[action_显示]
text:显示
pos:7
buildSpeed:0s
isGuiBlinking:true
temporarilyAddTags:显示信息
allowMultipleInQueue:false
displayType:action
isVisible:if not self.tags(includes="显示信息")
[global_resource_概率]
hidden:true
[global_resource_压力值]
hidden:true
[global_resource_最高战力]
hidden:true
[global_resource_军队战力]
hidden:true
[action_显示信息]
text:< %{memory.难度} >\n阶段：%{(int(self.resource.AI阶段))}\n信用：%{(self.resource.信用)}\n概率：%{(self.resource.概率)}
description:重拦：%{(numberOfUnitsInTeam(withTag="重拦"))} 两栖：%{(numberOfUnitsInTeam(withTag="喷气机"))} 猛犸：%{(numberOfUnitsInTeam(withTag="猛犸"))} 重坦：%{(numberOfUnitsInTeam(withTag="重坦"))}\n全队重拦：%{(numberOfUnitsInTeam(withTag="重拦")+self.numberOfUnitsInAllyNotOwnTeam(withTag="重拦"))}\n战术变更可能性%{100-max(100-(self.resource.AI难度*(2.5+self.resource.AI难度))*0.5, 80)}％\n地图形式：%{select(self.globalTeamTags(includes="左右图"), '左右图', '上下图')} 自身位置：%{select(self.globalTeamTags(includes="图上"), '图上', '图下')} %{select(self.globalTeamTags(includes="图左"), '图左', '图右')}\n压力值：%{self.resource.压力值} 敌方军队%{self.resource.军队战力} 敌方最高战力%{self.resource.最高战力}
isVisible:if self.tags(includes="显示信息")
buildSpeed:0s
displayType:infoOnly
allowMultipleInQueue:false
isAlsoViewableByAllies:true
isAlsoViewableByEnemies:true
isGuiBlinking:true
isActive:false
pos:8
ai_isDisabled:true
[action_禁空]
text:请求禁空
isVisible:if self.tags(includes="显示信息") and numberOfUnitsInAllTeams(withTag="同意禁空", lessThan=1)
description:当队友进行投票后禁用空军单位
buildSpeed:0s
allowMultipleInQueue:false
temporarilyAddTags:开始投票, 同意禁空, 投票主办
displayType:action
isGuiBlinking:true
showMessageToAllPlayers:%{self.teamId+1}号玩家请求禁用空军，请各位玩家尽快在指挥中心完成投票
pos:9
ai_isDisabled:true
isLocked:if self.isControlledByAI
[action_投票同意禁空]
text:同意禁空
isVisible:if numberOfUnitsInAllTeams(withTag="同意禁空", greaterThan=0) and not self.tags(includes="同意禁空") and not self.tags(includes="拒绝禁空") and not self.isControlledByAI
showMessageToAllPlayers:%{self.teamId+1}号玩家同意禁空
temporarilyAddTags:同意禁空
buildSpeed:0s
allowMultipleInQueue:false
displayType:action
isGuiBlinking:true
pos:1.1
ai_isDisabled:true
isLocked:if self.isControlledByAI
[action_投票拒绝禁空]
text:拒绝禁空
isVisible:if numberOfUnitsInAllTeams(withTag="同意禁空", greaterThan=0) and not self.tags(includes="同意禁空") and not self.tags(includes="拒绝禁空") and not self.isControlledByAI
showMessageToAllPlayers:%{self.teamId+1}号玩家拒绝禁空
temporarilyAddTags:拒绝禁空
buildSpeed:0s
allowMultipleInQueue:false
displayType:action
isGuiBlinking:true
pos:1.2
ai_isDisabled:true
isLocked:if self.isControlledByAI
[global_resource_投票等待时长]
hidden:true
[hiddenAction_投票时长增加]
requireConditional:if self.tags(includes="开始投票") and not self.hasResources(投票等待时长=10)
addResources:投票等待时长:0.2
[hiddenAction_禁空投票结算]
autoTrigger:true
requireConditional:if self.tags(includes="开始投票") and self.tags(includes="同意禁空") and self.hasResources(投票等待时长=10)
setResourcesWithLogic:投票等待时长:0
temporarilyRemoveTags:开始投票
alsoTriggerAction:同意禁空, 拒绝禁空
[hiddenAction_同意禁空]
requireConditional:if numberOfUnitsInAllTeams(withTag="同意禁空")>=numberOfUnitsInAllTeams(withTag="拒绝禁空") and self.tags(includes="投票主办")
temporarilyRemoveTags:投票主办
produceUnits:禁空
showMessageToAllPlayers:本局已禁用空军
[hiddenAction_拒绝禁空]
requireConditional:if numberOfUnitsInAllTeams(withTag="同意禁空")<numberOfUnitsInAllTeams(withTag="拒绝禁空") and self.tags(includes="投票主办")
temporarilyRemoveTags:投票主办
showMessageToAllPlayers:多数玩家拒绝禁空，本次对局将不再启用禁空投票选项
[action_隐藏]
text:隐藏信息
pos:7
buildSpeed:0s
isGuiBlinking:true
temporarilyRemoveTags:显示信息
displayType:action
isVisible:if self.tags(includes="显示信息")