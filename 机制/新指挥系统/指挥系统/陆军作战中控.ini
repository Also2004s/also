[核心]
name:陆军作战中控
tags:陆军作战中控, 作战中控
复制与:作战通用模块.ini
@memory 附属检测:unit
@memory 目标:unit[]
@memory 攻击目标:unit
不可选择:false
禁止加载:true
[全局资源_最高战力]
隐藏:true
[全局资源_军队战力]
隐藏:true
[全局资源_压力值]
隐藏:true
[资源_陆军]
隐藏:true
[图像]
可见性:true
[移动]
运动类型:跨悬崖
移动速度:0.8
移动忽略转向:true
[行动_信息]
可见性:true
text:%{内存.攻击目标.resource.总战力}\n%{(内存.攻击目标.readUnitMemory('阵地对地战力', type='float')+内存.攻击目标.readUnitMemory('阵地对地战力X', type='float'))} \n%{select(自身有标签(包含标签="发起进攻"), '只手炼化', '道友饶命')}
建造速度:0s
显示类型:infoOnly
显示给盟友:true
显示给敌人:true
界面闪烁:true
位置:0
[行动_信息1]
可见性:true
text:聚集:%{自身有标签(包含标签='聚集')}\n开始进攻:%{自身有标签(包含标签='开始进攻')}\n未下达指令:%{自身有标签(包含标签='未下达指令')}\n总战力:%{自身资源.总战力}\n最高战力:%{自身资源.最高战力}\n附属陆军:%{内存.附属检测.resource.陆军}
建造速度:0s
显示类型:infoOnly
显示给盟友:true
显示给敌人:true
界面闪烁:true
位置:10
#––「记忆系统」––#
[隐藏行动_检索敌人]
自动触发:if not 自身有活动的路径点(type='touchTarget')
需要条件:if 敌人有此单位数量(需标签="地", 范围内=300, 超过=0) or 敌人有此单位数量(需标签="地", 范围内=520, 超过=0) and not 自身有标签(包含标签="发起进攻")
清除所有路径点:true
添加路径点动作类型:touchTarget
添加路径点检索标签:前线
添加路径点靠近队伍:盟友
[隐藏行动_压力值]
自动触发:true
需要条件:if 自身资源.时间%15>=3 and 自身资源.军队战力>=1 and 存活时间(指定时间后=5) and 自身资源.总战力>=1 and 自身自定义计时器(指定时间后=1)
重置自定义计时器:true
用逻辑设置资源:压力值=0.4+((自身资源.军队战力+0.01)/(自身资源.总战力+0.01))*0.6
#––「战力模块」––#
[隐藏行动_检索战力]
提取资源标签:陆军
takeResources_triggerActionForEach:军队战力
#––「战力链接」––#
[隐藏行动_检索盟友]
提取资源标签:陆军作战中控
takeResources_triggerActionForEach:盟友战力
#––「唯一设定」––#
[隐藏行动_区块消失]
自动触发:if 敌人有此单位数量(需标签="作战区块", 超过=0)
需要条件:if 自身有资源(冷却=30) and 自身有资源(时间=240) or 队伍中此单位数量(需标签="陆军作战中控", 范围内=250, 超过=1)
#––「兵力聚集」––#
[隐藏行动_判断分散]
自动触发:true
# 移除对时间片的依赖，减少因时间模运算导致的不同步卡死
需要条件:if 队伍中此单位数量(需标签="陆军", 范围内=460)>(内存.附属检测.resource.陆军*(1+队伍中此单位数量(需标签="陆军", 范围内=460)*0.0036)) and 自身资源.时间%5==3 and 自身资源.总战力<自身资源.最高战力*1.44 and not 自身有标签(包含标签="开始进攻") and 自身资源.时间%15>=3
临时标签删除:聚集, 开始进攻, 发起进攻
临时标签添加:未下达指令
[隐藏行动_判断聚集]
自动触发:true
需要条件:if 队伍中此单位数量(需标签="陆军", 范围内=460)<=(内存.附属检测.resource.陆军*(1+队伍中此单位数量(需标签="陆军", 范围内=460)*0.0036)) or 自身资源.总战力>自身资源.最高战力*1.44>0 and 队伍中此单位数量(需标签="陆军", 范围内=250, 超过=0)
临时标签添加:聚集
#––「作战模块」––#
[隐藏行动_判断进攻]
自动触发:if 敌人有此单位数量(需标签="地", 范围内=300, 少于=1) and 自身有标签(包含标签="发起进攻") or 敌人有此单位数量(需标签="地", 范围内=520, 少于=1)
需要条件:if 自身有资源(总战力=52) and 自身有标签(包含标签="聚集") and 自身资源.时间%15>=3 and not 自身有活动的路径点(type='follow') or 自身有标签(包含标签="开始进攻") and not 自身有活动的路径点(type='follow')
临时标签删除:未下达指令
清除所有路径点:true
添加路径点动作类型:follow
添加路径点检索标签:作战区块
添加路径点靠近队伍:enemy
添加路径点匹配触发:存储战力
添加路径点失败触发:区块消失
[隐藏行动_存储战力]
需要条件:if 自身有活动的路径点(type='follow') and 活动路径点目标.tags(包含标签="作战区块")
设置单位内存:攻击目标=活动路径点目标
也执行动作:更换目标
[隐藏行动_clear_invalid_follow]
自动触发:true
# 清理失效的 follow waypoint，防止目标被删除后卡住
需要条件:if 自身有活动的路径点(type='follow') and (活动路径点目标==空单位 or 活动路径点目标.hp<1)
清除所有路径点:true
临时标签添加:未下达指令
[隐藏行动_更换目标]
需要条件:if 活动路径点目标.resource.总战力==0 or 自身资源.总战力<(活动路径点目标.readUnitMemory('阵地对地战力', type='float')+活动路径点目标.readUnitMemory('阵地对地战力X', type='float'))*1.2 and 活动路径点目标.tags(包含标签="作战区块") and 自身资源.时间%15>=3
清除所有路径点:true
添加路径点动作类型:follow
添加指定标签的随机单位:作战区块
添加指定队伍的随机单位:enemy
添加路径点匹配触发:存储战力
[隐藏行动_heartbeat]
自动触发:true
# 温和心跳：若长时间无跟随且无聚集，恢复聚集状态并清理 waypoint，防止整把停滞
需要条件:if not 自身有活动的路径点(type='follow') and not 自身有标签(包含标签='聚集') and 存活时间(指定时间后=25)
临时标签添加:聚集
清除所有路径点:true
[隐藏行动_开始进攻]
自动触发:true
需要条件:if 自身有标签(包含标签="聚集") and 自身资源.总战力>=内存.攻击目标.resource.总战力*1.144
临时标签添加:开始进攻
临时标签删除:发起撤退
[隐藏行动_开始作战]
自动触发:true
需要条件:if 自身有标签(包含标签="开始进攻") and 队伍中此单位数量(需标签="陆军", 范围内=460)<=(内存.附属检测.resource.陆军*(1+队伍中此单位数量(需标签="陆军", 范围内=460)*0.008))
临时标签添加:发起进攻
[隐藏行动_取消进攻]
自动触发:true
需要条件:if 自身资源.总战力<内存.攻击目标.resource.总战力*1.144 and 自身资源.时间%15>=12
临时标签删除:开始进攻, 发起进攻