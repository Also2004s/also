[core]
name:检测悬崖
copyFrom:ROOT:/机制/通用模版.ini
onNewMapSpawn:emptyOrOccupiedResourcePools_asNeutral
stayNeutral:true
tags:检测悬崖
radius:25
isUnselectable:true
autoTriggerCooldownTime:0.4s
[graphics]
isVisible:false
[movement]
movementType:HOVER
moveSpeed:0.1
moveIgnoringBody:true
[hiddenAction_检测地形]
autoTrigger:true
requireConditional:if not self.tags(includes="悬崖点") and self.timeAlive(laterThanSeconds=0.4)
addWaypoint_type:move
addWaypoint_target_nearestUnit_team:any
addWaypoint_target_nearestUnit_tagged:建筑物, 建造, I
addWaypoint_target_mapMustBeReachable:true
addWaypoint_triggerActionIfMatched:死亡
addWaypoint_triggerActionIfFailed:悬崖
[hiddenAction_悬崖]
clearAllWaypoints:true
temporarilyAddTags:悬崖点
[hiddenAction_死亡]
deleteSelf:true

[hiddenAction_检测建造]
autoTrigger:true
requireConditional:if self.tags(includes="悬崖点")
addWaypoint_type:move
addWaypoint_target_nearestUnit_team:any
addWaypoint_target_nearestUnit_tagged:建造
addWaypoint_target_mapMustBeReachable:true
addWaypoint_triggerActionIfMatched:可达
addWaypoint_triggerActionIfFailed:不可达
[hiddenAction_可达]
clearAllWaypoints:true
temporarilyRemoveTags:建造不可达
[hiddenAction_不可达]
requireConditional:if numberOfUnitsInAllTeams(withTag="经济", withinRange=25, lessThan=1)
clearAllWaypoints:true
temporarilyAddTags:建造不可达